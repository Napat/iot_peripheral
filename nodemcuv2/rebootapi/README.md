
Software reset ESP8266
-----
ในหลายๆครั้งเมื่อเราพัฒนาโปรแกรมจะเจอปัญหาบางอย่างเช่นไม่สามารถ connect Wifi router ได้และยังไม่ทราบหรือสามารถแก้ไขปัญหาที่ต้นเหตุได้
ทำให้มีความจำเป็นจะต้องเขียนโปรแกรมเพื่อสั่ง reset ESP8266 เพื่อเริ่มการทำงานใหม่เพื่อแก้ปัญหาเฉพาะหน้าไปก่อน(ไม่แนะนำให้ทิ้งปัญหาไว้โดยไม่ยอมแก้นะครับ แต่ต้องยอมรับอย่างหนึ่งว่าถ้าจะใช้ arduino platform ในการพัฒนาโปรแกรมแล้ว ในหลายๆครั้งมักจะเจอปัญหาที่ไม่สามารถแก้ไขเองได้เพราะไม่สามารถลงไปแก้ไขในระดับล่างๆได้)  
มี api เพื่อทำ software reset อยู่สอง function คือ ESP.restart() และ ESP.reset()  
  
ESP.reset() คือการสั่ง reset ไปที่ esp8266 โดยตรงเลย ถ้าไปอ่านในเว็บของฝรั่งเค้าจะเรียกว่าคือการ hard reset (เข้าใจว่าไม่ใช่ hard reset ในความหมายของ hardware reset จริงๆ)ซึ่ง function นี้ไม่ได้เคลียค่า register บางตัวและอาจจะเกิดปัญหาในการใช้งานได้จึงแนะนำให้ใช้ function ถัดไปแทน  

ESP.restart() เป็นการสั่ง reboot ผ่าน SDK ทำให้มีการเคลียค่าต่างๆที่ดีกว่า แนะนำให้ใช้ function นี้ในการเขียนโปรแกรม  

*[known issue](https://github.com/esp8266/Arduino/issues/1017)* หลังจาก flashing โปรแกรมผ่าน serial port เมื่อโปรแกรมทำงานครั้งแรกและเรียกใช้คำสั่ง software reboot จะเกิดอาหาร hang ขึ้นโดยจะมีการแจ้งออกมาทาง serial debug ว่า ` boot mode:(1,7)` แล้วก็จะค้างไปเลย

![](res/knownIssue1017EspHang.jpg?raw=true)

แต่ปัญหาดังกล่าวไม่รุนแรงมากนักเพราะจะเป็นเฉพาะหลังจาก flash โปรแกรมเท่านั้น  
เมื่อทำการ hardware reset(กดปุ่่ม reset หรือปิด/เปิดไฟใหม่) แล้วจะสามารถสั่ง software reset ได้อย่างปกติดังรูป    

![](res/afterVeryFirstReset.jpg?raw=true)
